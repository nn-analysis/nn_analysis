<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 6.6.0" />
    <title>nn_analysis.storage API documentation</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%2244.5%202.5%2015%2015%22%3E%3Cpath%20d%3D%22M49.351%2021.041c-.233-.721-.546-2.408-.772-4.076-.042-.09-.067-.187-.046-.288-.166-1.347-.277-2.625-.241-3.351-1.378-1.008-2.271-2.586-2.271-4.362%200-.976.272-1.935.788-2.774.057-.094.122-.18.184-.268-.033-.167-.052-.339-.052-.516%200-1.477%201.202-2.679%202.679-2.679.791%200%201.496.352%201.987.9a6.3%206.3%200%200%201%201.001.029c.492-.564%201.207-.929%202.012-.929%201.477%200%202.679%201.202%202.679%202.679a2.65%202.65%200%200%201-.269%201.148c.383.747.595%201.572.595%202.41%200%202.311-1.507%204.29-3.635%205.107.037.699.147%202.27.423%203.294l.137.461c.156%202.136-4.612%205.166-5.199%203.215zm.127-4.919a4.78%204.78%200%200%200%20.775-.584c-.172-.115-.505-.254-.88-.378zm.331%202.302l.828-.502c-.202-.143-.576-.328-.984-.49zm.45%202.157l.701-.403c-.214-.115-.536-.249-.891-.376l.19.779zM49.13%204.141c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm.735-.389a1.15%201.15%200%200%201%20.314.783%201.16%201.16%200%200%201-1.162%201.162c-.457%200-.842-.27-1.032-.653-.026.117-.042.238-.042.362a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.843-.626-1.535-1.436-1.654zm3.076%201.654a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.037-.009-.072-.011-.109-.21.3-.541.508-.935.508a1.16%201.16%200%200%201-1.162-1.162%201.14%201.14%200%200%201%20.474-.912c-.015%200-.03-.005-.045-.005-.926.001-1.679.754-1.679%201.68zm1.861-1.265c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm1.823%204.823c0-.52-.103-1.035-.288-1.52-.466.394-1.06.64-1.717.64-1.144%200-2.116-.725-2.499-1.738-.383%201.012-1.355%201.738-2.499%201.738-.867%200-1.631-.421-2.121-1.062-.307.605-.478%201.267-.478%201.942%200%202.486%202.153%204.51%204.801%204.51s4.801-2.023%204.801-4.51zm-3.032%209.156l-.146-.492c-.276-1.02-.395-2.457-.444-3.268a6.11%206.11%200%200%201-1.18.115%206.01%206.01%200%200%201-2.536-.562l.006.175c.802.215%201.848.612%202.021%201.25.079.295-.021.601-.274.837l-.598.501c.667.304%201.243.698%201.311%201.179.02.144.022.507-.393.787l-.564.365c1.285.521%201.361.96%201.381%201.126.018.142.011.496-.427.746l-.854.489c.064-1.19%201.985-2.585%202.697-3.248zM49.34%209.925c0-.667%201-.667%201%200%200%20.653.818%201.205%201.787%201.205s1.787-.552%201.787-1.205c0-.667%201-.667%201%200%200%201.216-1.25%202.205-2.787%202.205s-2.787-.989-2.787-2.205zm-.887-7.633c-.093.077-.205.114-.317.114a.5.5%200%200%201-.318-.886L49.183.397a.5.5%200%200%201%20.703.068.5.5%200%200%201-.069.703zm7.661-.065c-.086%200-.173-.022-.253-.068l-1.523-.893c-.575-.337-.069-1.2.506-.863l1.523.892a.5.5%200%200%201%20.179.685c-.094.158-.261.247-.432.247z%22%20fill%3D%22%233bb300%22/%3E%3C/svg%3E"/>


<style type="text/css">/*! * Bootstrap Reboot v5.0.0-beta1 (https://getbootstrap.com/) * Copyright 2011-2020 The Bootstrap Authors * Copyright 2011-2020 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}[tabindex="-1"]:focus:not(:focus-visible){outline:0!important}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus{outline:dotted 1px;outline:-webkit-focus-ring-color auto 5px}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style type="text/css">/*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}</style>
<style type="text/css">/*! pdoc */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f7f7f7;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main{padding:2rem 3vw;}.git-button{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{display:none;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3, .pdoc h4{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;filter:opacity(1);}.pdoc details:not([open]){height:0;overflow:visible;}.pdoc details > summary{font-size:.75rem;cursor:pointer;color:var(--muted);border-width:0;padding:0 .7em;display:inline-block;display:inline list-item;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:3rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{color:var(--text);margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}</style>
</head>
<body>        <nav class="pdoc">
            <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
            <input id="togglestate" type="checkbox">
            <div>
                        <a class="pdoc-button module-list-button" href="../nn_analysis.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                            &nbsp;nn_analysis</a>




                    <h2>API Documentation</h2>
                        <ul class="memberlist">
            <li>
                    <a class="class" href="#NoSuchTableError">NoSuchTableError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#ShapeMismatchError">ShapeMismatchError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#TableNotInitialisedError">TableNotInitialisedError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#Database">Database</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Database.__init__">Database</a>
                        </li>
                        <li>
                                <a class="variable" href="#Database.folder">folder</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Table">Table</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Table.__init__">Table</a>
                        </li>
                        <li>
                                <a class="variable" href="#Table.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Table.database">database</a>
                        </li>
                        <li>
                                <a class="variable" href="#Table.verbose">verbose</a>
                        </li>
                        <li>
                                <a class="variable" href="#Table.folder">folder</a>
                        </li>
                        <li>
                                <a class="variable" href="#Table.shape">shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#Table.nrows">nrows</a>
                        </li>
                        <li>
                                <a class="variable" href="#Table.ncols">ncols</a>
                        </li>
                        <li>
                                <a class="variable" href="#Table.dtype">dtype</a>
                        </li>
                        <li>
                                <a class="variable" href="#Table.initialised">initialised</a>
                        </li>
                        <li>
                                <a class="function" href="#Table.change_dtype">change_dtype</a>
                        </li>
                        <li>
                                <a class="function" href="#Table.initialise">initialise</a>
                        </li>
                        <li>
                                <a class="function" href="#Table.append_rows">append_rows</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TableSet">TableSet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TableSet.__init__">TableSet</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.database">database</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.verbose">verbose</a>
                        </li>
                        <li>
                                <a class="function" href="#TableSet.initialise">initialise</a>
                        </li>
                        <li>
                                <a class="function" href="#TableSet.append_rows">append_rows</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.shape">shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.nrows">nrows</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.ncols">ncols</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.folder">folder</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.subtables">subtables</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.recurrent_subtables">recurrent_subtables</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.ncols_tuple">ncols_tuple</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.dtype">dtype</a>
                        </li>
                        <li>
                                <a class="function" href="#TableSet.change_dtype">change_dtype</a>
                        </li>
                        <li>
                                <a class="variable" href="#TableSet.initialised">initialised</a>
                        </li>
                        <li>
                                <a class="function" href="#TableSet.print_structure">print_structure</a>
                        </li>
                        <li>
                                <a class="function" href="#TableSet.get_subtable">get_subtable</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#StorageManager">StorageManager</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#StorageManager.__init__">StorageManager</a>
                        </li>
                        <li>
                                <a class="variable" href="#StorageManager.database">database</a>
                        </li>
                        <li>
                                <a class="function" href="#StorageManager.save_result_table_set">save_result_table_set</a>
                        </li>
                        <li>
                                <a class="function" href="#StorageManager.open_table">open_table</a>
                        </li>
                        <li>
                                <a class="function" href="#StorageManager.remove_table">remove_table</a>
                        </li>
                </ul>

            </li>
    </ul>


                    <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <span class="visually-hidden">pdoc</span><img
                            alt="pdoc logo"
                            src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
                    </a>
            </div>
        </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
<a href="./../nn_analysis.html">nn_analysis</a><wbr>.storage    </h1>

                
                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">class</span> <span class="nc">NoSuchTableError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">ShapeMismatchError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">TableNotInitialisedError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">def</span> <span class="nf">__slicetolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts slices to lists of indices</span>

<span class="sd">    Args:</span>
<span class="sd">        key: (slice) The key</span>
<span class="sd">        length: (int, optional) The length of the slice. default=nrows</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: List of indices</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">key</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">start</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">stop</span>
    <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">stop</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">length</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">step</span>
    <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts key to a list as preprocessing for object retrieval/alteration/deletion</span>

<span class="sd">    Args:</span>
<span class="sd">        key: Key of the index</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: List of indices</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">__slicetolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">length</span><span class="p">),</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected &lt;=2, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">key</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">__slicetolist__</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">rows</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">key</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the data is a tuple of tuples or np.ndarrays everywhere</span>

<span class="sd">    Args:</span>
<span class="sd">        data: The data of the subtables</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if it does, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subdata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">subdata</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="ow">and</span> <span class="n">subdata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>


<span class="k">class</span> <span class="nc">Database</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing database wide properties</span>

<span class="sd">    When initialising the class the database folder will be created if it does not exist</span>

<span class="sd">    Args:</span>
<span class="sd">        folder (str) : The folder the database resides in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">folder</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Table</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class containing the table structure.</span>
<span class="sd">    The table stores each row in separate files on the machine to offload ram.</span>
<span class="sd">    Since file structure are not well equipped to handle a (very) large amount of files,</span>
<span class="sd">    do keep that in mind when initialising tables and transpose the data if necessary.</span>

<span class="sd">    Tables store rows with other dimensions removed.</span>

<span class="sd">    Slicing</span>
<span class="sd">    -----------</span>
<span class="sd">    Tables can be accessed using slicing. Slicing in Tables works similar to slicing in Numpy arrays.</span>

<span class="sd">    Slicing support both get, set, and delete commands.</span>

<span class="sd">    Examples</span>
<span class="sd">    -----------</span>
<span class="sd">    &gt;&gt;&gt; table[1,2]</span>
<span class="sd">    3 &lt;-- this is the element in the second row, in the third column of the `Table`.</span>
<span class="sd">    &gt;&gt;&gt; table[1,2:4]</span>
<span class="sd">    Array([3, 4]) &lt;-- The second and third column of the second row.</span>
<span class="sd">    &gt;&gt;&gt; table[1:5]</span>
<span class="sd">    Array([[1,2,3,4],[2,3,4,5],[3,4,5,6],[4,5,6,7]]) &lt;-- The rows from the second row to the fifth row in a `Table` with 4 columns.</span>


<span class="sd">    Args:</span>
<span class="sd">        name: The name of the `Table`</span>
<span class="sd">        database: The `Database` the Table resides in</span>
<span class="sd">        table_set: The `TableSet` that is the parent of this `Table`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__properties_file</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">database</span><span class="p">:</span> <span class="n">Database</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">,</span> <span class="n">table_set</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;properties&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="o">=</span> <span class="n">table_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The shape of the table&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nrows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The number of rows in the table&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ncols</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The number of columns in the table&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The datatype of the table&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">initialised</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Indicates whether the necessary files are initialised and whether the shapes are correct&quot;&quot;&quot;</span>
        <span class="n">properties_exist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">properties_exist</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
                <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ncols</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">last_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">last_row</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">inputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">outputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">last_row</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">ncols</span>

    <span class="k">def</span> <span class="nf">__calc_properties__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the properties of the table including the nrows and ncols&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span>

    <span class="k">def</span> <span class="nf">__update_properties__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates the properties of the table including the nrows and ncols&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">),</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">change_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the dtype of the table</span>

<span class="sd">        Args:</span>
<span class="sd">            dtype: The desired `np.dtype`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">initialise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises the table using the np.ndarray provided</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; Table(&#39;Name&#39;, Database(&#39;path&#39;)).initialise(np.array([[1,2,3,4],[2,3,4,5]]))</span>
<span class="sd">        Creates a table with name &#39;Name&#39; and two rows of data Array([[1,2,3,4], [2,3,4,5]])</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The array containing the data for the Table</span>
<span class="sd">            dtype (optional): The dtype of the data, changes the data&#39;s dtype if they don&#39;t match</span>
<span class="sd">            inputs (optional): Denotes the inputs for the data in this Table represented as a list of Table names. Table names have to be in the same TableSet or Database.</span>
<span class="sd">            outputs (optional): Denotes the outputs for the data in this Table represented as a list of Table names. Table names have to be in the same TableSet or Database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
        <span class="c1"># Make data 2 dimensional</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="c1"># Change dtype if necessary</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="c1"># Go through all the data with a progress bar</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">append_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new row to the existing Table</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; Table(&#39;Name&#39;, Database(&#39;path&#39;)).append_rows(np.array([[10,11,12,13], [11, 12, 13, 14]]))</span>
<span class="sd">        Adds rows Array([[10,11,12,13], [11, 12, 13, 14]]) to the existing table at path &#39;path&#39; with name &#39;Name&#39;.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The new rows as an np.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Expected data.shape[1] to match self.ncols!&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reshaped_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">+=</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Table(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Go through all rows that need to be fetched and display a progress bar</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="c1"># Try to fetch the columns and add them to the results</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">row</span><span class="p">)[</span><span class="n">cols</span><span class="p">]))</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2"> is out of bounds for axis 0 with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Make the result an np.array again and return them as a list if there is more than one item, else return that item</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="n">cols_is_slice</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cols_len</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span>
                <span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">expected_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">),)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">cols_is_slice</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">cols_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">__slicetolist__</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">))</span>
            <span class="n">expected_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="n">cols_len</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">expected_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">),)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2"> is out of bounds for axis 0 with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected value of type np.ndarray, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns, found </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">updated</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">elif</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows, got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns, found </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">updated</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected array of &lt;=2 dimensions, got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols_is_slice</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">cols_len</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected array of shape (</span><span class="si">{</span><span class="n">cols_len</span><span class="si">}</span><span class="s2">,), got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">value_to_set</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">expected_shape</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected array of shape </span><span class="si">{</span><span class="n">expected_shape</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">value_to_set</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected array of &lt;=2 dimensions, got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value_to_set</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">updated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">updated</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_to_set</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__deletefile__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">updated</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table does not support deleting columns&quot;</span><span class="p">)</span>
        <span class="n">old_nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__deletefile__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="n">removed</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">old_nrows</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)):</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span> <span class="o">-</span> <span class="n">removed</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">removed</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2"> is out of bounds for axis 0 with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">removed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">old_nrows</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span> <span class="o">-</span> <span class="n">removed</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">removed</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__readfile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the table before using it!&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__writefile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the table before using it!&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__deletefile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the table before using it!&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">TableSet</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A set of `Table`s and or other `TableSet`s.</span>
<span class="sd">    The get, set, and delete functions work on the aggregated table data.</span>
<span class="sd">    To get a specific subtable you can use `get_subtable(key)`</span>

<span class="sd">    Slicing</span>
<span class="sd">    -----------</span>
<span class="sd">    TableSets can be accessed using slicing. Slicing in TableSets works similar to slicing in Numpy arrays.</span>

<span class="sd">    The `TableSet` slicing combines all subtables into one structure. When using slicing the underlying subtables are combined.</span>

<span class="sd">    Slicing support both get, set, and delete commands.</span>

<span class="sd">    Examples</span>
<span class="sd">    -----------</span>
<span class="sd">    &gt;&gt;&gt; tableset[1,2]</span>
<span class="sd">    3 &lt;-- this is the element in the second row, in the third column of the `TableSet`.</span>
<span class="sd">    &gt;&gt;&gt; tableset[1,2:4]</span>
<span class="sd">    Array([3, 4]) &lt;-- The second and third column of the second row.</span>
<span class="sd">    &gt;&gt;&gt; tableset[1:5]</span>
<span class="sd">    Array([[1,2,3,4],[2,3,4,5],[3,4,5,6],[4,5,6,7]]) &lt;-- The rows from the second row to the fifth row in a `TableSet` with 4 columns.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: Name of the `TableSet`.</span>
<span class="sd">        database: The `database` the TableSet is in.</span>
<span class="sd">        table_set (optional): The TableSet this TableSet is a part of.</span>
<span class="sd">        verbose: If true progress bars are shown during some operations</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Name of the TableSet.</span>
<span class="sd">        database: The database the TableSet is in.</span>
<span class="sd">        table_set (optional): The TableSet this TableSet is a part of.</span>
<span class="sd">        verbose (optional, default=False): If true progress bars are shown during some operations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">database</span><span class="p">:</span> <span class="n">Database</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">,</span> <span class="n">table_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="o">=</span> <span class="n">table_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span> <span class="o">=</span> <span class="s1">&#39;properties&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__recurrent_subtables</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Table(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2">), &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">subtable_total</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">subtables</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">subtable_total</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">subtable_total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtables</span><span class="p">)[</span><span class="n">row</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">subtable_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">subtable_total</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtables</span><span class="p">)[</span><span class="n">row</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subtable_total</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subtable_total</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2"> is out of bounds for axis 0 with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>

        <span class="c1"># Make sure the shape and types of the keys and the values is something we expect</span>
        <span class="n">single_value</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">len_value</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">len_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">len_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span>
                <span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">len_value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expected len(value)=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s1">, found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">single_value</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span><span class="p">:</span>
            <span class="n">cols_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">__slicetolist__</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">len_value</span> <span class="o">!=</span> <span class="n">cols_len</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expected len(value)=</span><span class="si">{</span><span class="n">cols_len</span><span class="si">}</span><span class="s1">, found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">cols_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">len_value</span> <span class="o">!=</span> <span class="n">cols_len</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expected len(value)=</span><span class="si">{</span><span class="n">cols_len</span><span class="si">}</span><span class="s1">, found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">single_value</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">len_value</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expected len(value)=1, found len(value)=</span><span class="si">{</span><span class="n">len_value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Go through the subtables to delegate the values to the correct subtables</span>
        <span class="n">min_col</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">subtable_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span>
            <span class="n">max_col</span> <span class="o">=</span> <span class="n">min_col</span> <span class="o">+</span> <span class="n">subtable_instance</span><span class="o">.</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span>
            <span class="c1"># If only one value is changed check if that column is in the subtable and update it accordingly</span>
            <span class="k">if</span> <span class="n">single_value</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">min_col</span> <span class="o">&lt;=</span> <span class="n">cols</span> <span class="o">&lt;=</span> <span class="n">max_col</span><span class="p">:</span>
                    <span class="n">subtable_instance</span><span class="p">[</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Select the columns that are in this subtable</span>
                <span class="n">cols_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">__slicetolist__</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">))</span>
                <span class="n">cols_array</span> <span class="o">=</span> <span class="n">cols_array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&gt;=</span> <span class="n">min_col</span><span class="p">)]</span>
                <span class="n">cols_array</span> <span class="o">=</span> <span class="n">cols_array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&lt;=</span> <span class="n">max_col</span><span class="p">)]</span>
                <span class="n">value_array</span> <span class="o">=</span> <span class="n">value</span>
                <span class="c1"># Select just the values for the columns in this subtable</span>
                <span class="k">if</span> <span class="n">value_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">value_array</span> <span class="o">=</span> <span class="n">value_array</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&gt;=</span> <span class="n">min_col</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">value_array</span> <span class="o">=</span> <span class="n">value_array</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&lt;=</span> <span class="n">max_col</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value_array</span> <span class="o">=</span> <span class="n">value_array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&gt;=</span> <span class="n">min_col</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">value_array</span> <span class="o">=</span> <span class="n">value_array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&lt;=</span> <span class="n">max_col</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="c1"># Make sure the columns start at the right place</span>
                <span class="n">cols_array</span> <span class="o">=</span> <span class="n">cols_array</span> <span class="o">-</span> <span class="n">min_col</span>
                <span class="c1"># Make the columns a list and update the subtable with the values and columns that were just calculated</span>
                <span class="n">cols_list</span> <span class="o">=</span> <span class="n">cols_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">subtable_instance</span><span class="p">[</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols_list</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_array</span>
            <span class="n">min_col</span> <span class="o">+=</span> <span class="n">subtable_instance</span><span class="o">.</span><span class="n">ncols</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__verify_data_and_names_have_matching_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the data and names have the same size</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The data of the subtables</span>
<span class="sd">            names: The names of the subtables and subtablesets</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if they share the same size, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subdata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_data_and_names_have_matching_shapes</span><span class="p">(</span><span class="n">subdata</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">return</span> <span class="kc">False</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__verify_coherent_data_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the data has a coherent amount of rows everywhere</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The data of the subtables</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if it does, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">subdata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_coherent_data_rows</span><span class="p">(</span><span class="n">subdata</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">nrows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="n">subdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">nrows</span> <span class="o">!=</span> <span class="n">subdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__verify_name_types_are_correct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the names is a dict of dicts or strings everywhere</span>

<span class="sd">        Args:</span>
<span class="sd">            names: The names of the subtables and subtablesets</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if it does, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_name_types_are_correct</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">initialise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">relations</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise the TableSet with the structure set in the data parameter.</span>
<span class="sd">        Names and data need to be of the same shape.</span>

<span class="sd">        The program will use the key of the names dict as the name of the Table or TableSet.</span>

<span class="sd">        It is possible to create sub TableSets by making nested dicts in the names variable and nested tuples in the</span>
<span class="sd">        data variable.</span>

<span class="sd">        Examples</span>
<span class="sd">        -----------</span>
<span class="sd">        &gt;&gt;&gt; TableSet(&#39;Name&#39;, Database(&#39;path&#39;)).initialise((np.array([[1,2,3]]), (np.array([[2,3,4]]))), {&#39;first_subtable&#39;:&#39;&#39;, &#39;second_subtable&#39;:{&#39;first_subtable&#39;:&#39;&#39;}})</span>
<span class="sd">        Initiliases a TableSet in the database with the given data and names</span>
<span class="sd">        &gt;&gt;&gt; TableSet(&#39;Name&#39;).initialise((np.array([[1,2,3]]), (np.array([[2,3,4]]), np.array([[3,4,5]]))), {&#39;first_subtable&#39;:&#39;&#39;, &#39;second_subtable&#39;:{&#39;first_subtable&#39;:&#39;&#39;, &#39;second_subtable&#39;:&#39;&#39;}}, relations={&#39;first_subtable&#39;:([], [&#39;second_subtable&#39;]), &#39;second_subtable&#39;:([&#39;first_subtable&#39;],[],{&#39;first_subtable&#39;:([],[&#39;second_subtable&#39;]), &#39;second_subtable&#39;:([&#39;first_subtable&#39;], [])})})</span>
<span class="sd">        Initialises a TableSet in the database with the given data and names that has defined inputs and outputs</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The data of the subtables</span>
<span class="sd">            names: The names of the subtables and subtablesets</span>
<span class="sd">            dtype (optional): Data type of the array</span>
<span class="sd">            relations (optional): Relations between components of the data in terms of inputs and outputs. Example: `{ &#39;name&#39;: (inputs=list of names, outputs=list of names, child=child dict),  &#39;name2&#39;: (inputs=list of names, outputs=list of names, child=child dict), etc... }`</span>
<span class="sd">            inputs (optional): Denotes the inputs for the data in this TableSet represented as a list of Table names. TableSet names have to be in the same TableSet or Database.</span>
<span class="sd">            outputs (optional): Denotes the outputs for the data in this TableSet represented as a list of Table names. TableSet names have to be in the same TableSet or Database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data is not a tuple of nested tuples of np.ndarrays or a tuple of np.ndarrays!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_name_types_are_correct</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;names is not a dict of nested dicts of strings or a dict of strings!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_data_and_names_have_matching_shapes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data and names do not have the same shape!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_coherent_data_rows</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected the rows of all np.ndarrays in the data variable to be of the same length!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">relations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relations</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">relations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relations</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">child</span> <span class="o">=</span> <span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">relations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relations</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="p">,</span>
                                                                             <span class="n">child</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Expected type&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__verify_ncols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subdata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">subtable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">subtable</span><span class="o">.</span><span class="n">__verify_ncols</span><span class="p">(</span><span class="n">subdata</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">subtable</span><span class="o">.</span><span class="n">ncols</span> <span class="o">!=</span> <span class="n">subdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">append_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">skip_verification</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new rows to the existing TableSet</span>

<span class="sd">        Examples</span>
<span class="sd">        -----------</span>
<span class="sd">        &gt;&gt;&gt; TableSet(&#39;Name&#39;, Database(&#39;path&#39;)).append_rows((np.array([[1,2,3,3]]),))</span>
<span class="sd">        Adds a single row to a TableSet with one subtable with 4 columns</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The new rows as a (nested) tuple of np.ndarrays</span>
<span class="sd">            skip_verification (optional, default=False) : If True the verification steps are skipped. This allows for faster processing and is used when this function calls itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Verify the data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_verification</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data is not a tuple of nested tuples of np.ndarrays or a tuple of np.ndarrays!&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_coherent_data_rows</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected the rows of all np.ndarrays in the data variable to be of the same length!&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_ncols</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;make sure data.ncols is the same as the existing ncols&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subtable_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">subtable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span> <span class="ow">is</span> <span class="n">TableSet</span><span class="p">:</span>
                <span class="n">subtable</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">skip_verification</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">subtable</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shape of the TableSet&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nrows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Amount of rows in this subtable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">nrows</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ncols</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Total amount of columns in this subtable&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span><span class="o">.</span><span class="n">ncols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="n">total</span>
        <span class="k">return</span> <span class="n">total</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">folder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">subtables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The names of the subtables in this TableSet&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">recurrent_subtables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Dictionary of names of subtables and subsubtables etc.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recurrent_subtables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recurrent_subtables</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">subtable_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subtable_instance</span><span class="p">)</span> <span class="ow">is</span> <span class="n">TableSet</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">subtable</span><span class="p">]</span> <span class="o">=</span> <span class="n">subtable_instance</span><span class="o">.</span><span class="n">recurrent_subtables</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">subtable</span><span class="p">]</span> <span class="o">=</span> <span class="n">subtable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__recurrent_subtables</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ncols_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Amount of columns split up by subtable&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span>
        <span class="n">ncols_tuple</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">subtable_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subtable_instance</span><span class="p">)</span> <span class="ow">is</span> <span class="n">TableSet</span><span class="p">:</span>
                <span class="n">ncols_tuple</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span><span class="o">.</span><span class="n">ncols_tuple</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ncols_tuple</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subtable_instance</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ncols_tuple</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The datatype of the TableSet&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span>

    <span class="k">def</span> <span class="nf">change_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the dtype of the TableSet</span>

<span class="sd">        Args:</span>
<span class="sd">            dtype: The desired dtype</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__calc_properties__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the properties of the table including the nrows and ncols&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span>

    <span class="k">def</span> <span class="nf">__update_properties__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">),</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">initialised</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Indicates whether the TableSet was (correctly) initialised&quot;&quot;&quot;</span>
        <span class="n">properties_exist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">properties_exist</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">subtables</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subtables</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">inputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">outputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">print_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints a map of the table structure</span>

<span class="sd">        Args:</span>
<span class="sd">            tabs: (Integer) Amount of tabs to print before the text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_subtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the `Table` or `TableSet` with the key</span>

<span class="sd">        Args:</span>
<span class="sd">            key: The key of the subtable as a string or integer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the TableSet before calling this function!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoSuchTableError</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Table</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>  <span class="c1"># Subtable is a Table</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>  <span class="c1"># Subtable is a TableSet</span>
            <span class="k">return</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">NoSuchTableError</span><span class="p">(</span><span class="s1">&#39;No subtable with this key was found to be initialised!&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__readfile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the TableSet before using it!&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__writefile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the TableSet before using it!&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">StorageManager</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class handling often used storage related queries such as saving results from an experiment or from fitting to a `TableSet`</span>

<span class="sd">    Args:</span>
<span class="sd">        database: `Database` the `Table`s and `TableSet`s should reside in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">database</span><span class="p">:</span> <span class="n">Database</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>

    <span class="k">def</span> <span class="nf">save_result_table_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table_labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">ncols</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">row_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                              <span class="n">append_rows</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TableSet</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function that saves a `TableSet` with the results.</span>
<span class="sd">        Results do not have to be complete. If the result is incomplete provide the nrows or ncols parameters.</span>
<span class="sd">        The lacking rows or columns will then be filled with zeros. When providing the additional results use the</span>
<span class="sd">        row_start and col_start parameters to indicate where the existing TableSet is to be overridden.</span>

<span class="sd">        If a result tuple is incomplete and has completely missing parts fill in the missing parts with None values.</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[1,2,3,4], [2,3,4,5]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;})</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows of data in a single subtable</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[1,2,3,4], [2,3,4,5]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, nrows=4)</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows of data appended with two rows of zeros in a single subtable</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[1,2,3,4], [2,3,4,5]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, ncols=(6,))</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows and four columns of data appended with two columns of zeros in a single subtable</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[3,4,5,6], [4,5,6,7]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, row_start=2)</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with four rows. The original `TableSet` was changed in rows 2 and 3 with the data given here.</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[3,4,5,6], [4,5,6,7]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, append_rows=True)</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with four rows. The original `TableSet` was appended with the two rows given here.</span>

<span class="sd">        Args:</span>
<span class="sd">            results: A (nested) tuple of np.ndarrays containing results</span>
<span class="sd">            name: (str) The name of the `TableSet` to be created or updated</span>
<span class="sd">            table_labels: A (nested) dictionary of the names of the `Table`s/`SubTable`s in the `TableSet`</span>
<span class="sd">            nrows (optional): Amount of rows that will (eventually) be in the `TableSet`. If not provided `nrows=results.shape[0]`</span>
<span class="sd">            ncols (optional): Amount of columns that will (eventually) be in the table set per subpart of the data. If not provided `ncols[i]=results[i].shape[1]`</span>
<span class="sd">            row_start (optional, default=0): Int of the row where the results start. This parameter is used if nrows does not match the amount of rows in the results.</span>
<span class="sd">            col_start (optional, default=0): Int of the column where the results start. This parameter is used if ncols does not match the amount of columns in the results.</span>
<span class="sd">            append_rows (optional, default=False): If true, when the `TableSet` is already initialised the results will be appended as rows to the existing `TableSet`</span>

<span class="sd">        Returns:</span>
<span class="sd">            `TableSet` containing the results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table_set</span> <span class="o">=</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;results is not a tuple of nested tuples of np.ndarrays or a tuple of np.ndarrays!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_results_and_ncols_shape</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">ncols</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ncols and results should be of the same shape&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_nrows_calculation</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nrows</span><span class="p">):</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fetch_nrows_from_partial_result_set</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_ncols_to_be_set_somewhere</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;When one of the results is None, ncols has to be set for that result!&#39;</span><span class="p">)</span>
        <span class="n">padded_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pad_with_zeros</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table_set</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>  <span class="c1"># Update existing TableSet</span>
            <span class="k">if</span> <span class="n">append_rows</span><span class="p">:</span>
                <span class="n">table_set</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">padded_results</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Combine the small arrays into one large array so we can use the TableSet update function</span>
                <span class="n">combined_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__combine_into_big_array</span><span class="p">(</span><span class="n">padded_results</span><span class="p">)</span>
                <span class="n">table_set</span><span class="p">[</span><span class="n">row_start</span><span class="p">:</span><span class="n">combined_results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">row_start</span><span class="p">,</span>
                          <span class="n">col_start</span><span class="p">:</span><span class="n">combined_results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">col_start</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_results</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">table_set</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">padded_results</span><span class="p">,</span> <span class="n">table_labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">table_set</span>

    <span class="k">def</span> <span class="nf">open_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a `Table` or `TableSet` in the `Database` with the given name.</span>
<span class="sd">        The function can automatically distinguish between `Table`s and `TableSet`s.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).open_table(&#39;Name&#39;)</span>
<span class="sd">        Table(&#39;Name&#39;) or TableSet(&#39;Name&#39;) if a `Table` or `TableSet` exists in this database.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the `Table` or `TableSet`</span>

<span class="sd">        Returns:</span>
<span class="sd">            `Table` or `TableSet`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoSuchTableError</span>

    <span class="k">def</span> <span class="nf">remove_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a table from the `Database`</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).remove_table(&#39;Name&#39;)</span>
<span class="sd">        Removes table with the name &#39;Name&#39; from the database at path &#39;path&#39;.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the `Table`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__requires_nrows_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nrows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># If the result is a tuple unpack it further</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_nrows_calculation</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__requires_ncols_to_be_set_somewhere</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># If the result is a tuple unpack it further</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_nrows_calculation</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__fetch_nrows_from_partial_result_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">nrows_subresult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fetch_nrows_from_partial_result_set</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nrows_subresult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">nrows_subresult</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;When all results are None values nrows has to be set!&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__verify_results_and_ncols_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ncols</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">tuple</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_results_and_ncols_shape</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__pad_with_zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">final_result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># If the result is a tuple unpack it further</span>
                <span class="n">this_ncols</span> <span class="o">=</span> <span class="n">ncols</span>
                <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">this_ncols</span> <span class="o">=</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__pad_with_zeros</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">this_ncols</span><span class="p">,</span> <span class="n">nrows</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># If the result is None fill the result using the ncols and nrows</span>
                <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;When a particular result is None, ncols for that result has to be set!&#39;</span><span class="p">)</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># If the result is a result fit it in a padded result array of shape (ncols, nrows)</span>
                <span class="n">flattened_array</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">this_nrows</span> <span class="o">=</span> <span class="n">flattened_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">this_ncols</span> <span class="o">=</span> <span class="n">flattened_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">nrows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">this_nrows</span> <span class="o">=</span> <span class="n">nrows</span>
                <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">this_ncols</span> <span class="o">=</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">padded_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">this_nrows</span><span class="p">,</span> <span class="n">this_ncols</span><span class="p">))</span>
                <span class="n">padded_array</span><span class="p">[:,</span> <span class="p">:</span><span class="n">flattened_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">flattened_array</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">padded_array</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">final_result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__combine_into_big_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">final_result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__combine_into_big_array</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">final_result</span><span class="p">)</span>
</pre></div>

        </details>

            </section>
                <section id="NoSuchTableError">
                                <div class="attr class">
        <a class="headerlink" href="#NoSuchTableError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">NoSuchTableError</span><wbr>(<span class="base">builtins.Exception</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">NoSuchTableError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>Common base class for all non-exit exceptions.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="NoSuchTableError.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="NoSuchTableError.with_traceback" class="function">with_traceback</dd>
                <dd id="NoSuchTableError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ShapeMismatchError">
                                <div class="attr class">
        <a class="headerlink" href="#ShapeMismatchError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ShapeMismatchError</span><wbr>(<span class="base">builtins.Exception</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ShapeMismatchError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>Common base class for all non-exit exceptions.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="ShapeMismatchError.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="ShapeMismatchError.with_traceback" class="function">with_traceback</dd>
                <dd id="ShapeMismatchError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TableNotInitialisedError">
                                <div class="attr class">
        <a class="headerlink" href="#TableNotInitialisedError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">TableNotInitialisedError</span><wbr>(<span class="base">builtins.Exception</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">TableNotInitialisedError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>Common base class for all non-exit exceptions.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="TableNotInitialisedError.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TableNotInitialisedError.with_traceback" class="function">with_traceback</dd>
                <dd id="TableNotInitialisedError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Database">
                                <div class="attr class">
        <a class="headerlink" href="#Database">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Database</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Database</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing database wide properties</span>

<span class="sd">    When initialising the class the database folder will be created if it does not exist</span>

<span class="sd">    Args:</span>
<span class="sd">        folder (str) : The folder the database resides in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">folder</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Class for storing database wide properties</p>

<p>When initialising the class the database folder will be created if it does not exist</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>folder (str) :</strong>  The folder the database resides in</li>
</ul>
</div>


                            <div id="Database.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Database.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Database</span><span class="signature">(folder: str)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">folder</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Database.folder" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Database.folder">#&nbsp;&nbsp</a>

        <span class="name">folder</span><span class="annotation">: str</span>
    </div>

    

                            </div>
                </section>
                <section id="Table">
                                <div class="attr class">
        <a class="headerlink" href="#Table">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Table</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Table</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class containing the table structure.</span>
<span class="sd">    The table stores each row in separate files on the machine to offload ram.</span>
<span class="sd">    Since file structure are not well equipped to handle a (very) large amount of files,</span>
<span class="sd">    do keep that in mind when initialising tables and transpose the data if necessary.</span>

<span class="sd">    Tables store rows with other dimensions removed.</span>

<span class="sd">    Slicing</span>
<span class="sd">    -----------</span>
<span class="sd">    Tables can be accessed using slicing. Slicing in Tables works similar to slicing in Numpy arrays.</span>

<span class="sd">    Slicing support both get, set, and delete commands.</span>

<span class="sd">    Examples</span>
<span class="sd">    -----------</span>
<span class="sd">    &gt;&gt;&gt; table[1,2]</span>
<span class="sd">    3 &lt;-- this is the element in the second row, in the third column of the `Table`.</span>
<span class="sd">    &gt;&gt;&gt; table[1,2:4]</span>
<span class="sd">    Array([3, 4]) &lt;-- The second and third column of the second row.</span>
<span class="sd">    &gt;&gt;&gt; table[1:5]</span>
<span class="sd">    Array([[1,2,3,4],[2,3,4,5],[3,4,5,6],[4,5,6,7]]) &lt;-- The rows from the second row to the fifth row in a `Table` with 4 columns.</span>


<span class="sd">    Args:</span>
<span class="sd">        name: The name of the `Table`</span>
<span class="sd">        database: The `Database` the Table resides in</span>
<span class="sd">        table_set: The `TableSet` that is the parent of this `Table`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__properties_file</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">database</span><span class="p">:</span> <span class="n">Database</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">,</span> <span class="n">table_set</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;properties&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="o">=</span> <span class="n">table_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The shape of the table&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nrows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The number of rows in the table&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ncols</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The number of columns in the table&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The datatype of the table&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">initialised</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Indicates whether the necessary files are initialised and whether the shapes are correct&quot;&quot;&quot;</span>
        <span class="n">properties_exist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">properties_exist</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
                <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ncols</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">last_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">last_row</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">inputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">outputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">last_row</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">ncols</span>

    <span class="k">def</span> <span class="nf">__calc_properties__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the properties of the table including the nrows and ncols&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span>

    <span class="k">def</span> <span class="nf">__update_properties__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates the properties of the table including the nrows and ncols&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">),</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">change_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the dtype of the table</span>

<span class="sd">        Args:</span>
<span class="sd">            dtype: The desired `np.dtype`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">initialise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises the table using the np.ndarray provided</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; Table(&#39;Name&#39;, Database(&#39;path&#39;)).initialise(np.array([[1,2,3,4],[2,3,4,5]]))</span>
<span class="sd">        Creates a table with name &#39;Name&#39; and two rows of data Array([[1,2,3,4], [2,3,4,5]])</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The array containing the data for the Table</span>
<span class="sd">            dtype (optional): The dtype of the data, changes the data&#39;s dtype if they don&#39;t match</span>
<span class="sd">            inputs (optional): Denotes the inputs for the data in this Table represented as a list of Table names. Table names have to be in the same TableSet or Database.</span>
<span class="sd">            outputs (optional): Denotes the outputs for the data in this Table represented as a list of Table names. Table names have to be in the same TableSet or Database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
        <span class="c1"># Make data 2 dimensional</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="c1"># Change dtype if necessary</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="c1"># Go through all the data with a progress bar</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">append_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new row to the existing Table</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; Table(&#39;Name&#39;, Database(&#39;path&#39;)).append_rows(np.array([[10,11,12,13], [11, 12, 13, 14]]))</span>
<span class="sd">        Adds rows Array([[10,11,12,13], [11, 12, 13, 14]]) to the existing table at path &#39;path&#39; with name &#39;Name&#39;.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The new rows as an np.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Expected data.shape[1] to match self.ncols!&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reshaped_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">+=</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Table(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Go through all rows that need to be fetched and display a progress bar</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="c1"># Try to fetch the columns and add them to the results</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">row</span><span class="p">)[</span><span class="n">cols</span><span class="p">]))</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2"> is out of bounds for axis 0 with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Make the result an np.array again and return them as a list if there is more than one item, else return that item</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="n">cols_is_slice</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cols_len</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span>
                <span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">expected_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">),)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">cols_is_slice</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">cols_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">__slicetolist__</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">))</span>
            <span class="n">expected_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="n">cols_len</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">expected_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">),)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2"> is out of bounds for axis 0 with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected value of type np.ndarray, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns, found </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">updated</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">elif</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows, got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns, found </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">updated</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected array of &lt;=2 dimensions, got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols_is_slice</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">cols_len</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected array of shape (</span><span class="si">{</span><span class="n">cols_len</span><span class="si">}</span><span class="s2">,), got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">value_to_set</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">expected_shape</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected array of shape </span><span class="si">{</span><span class="n">expected_shape</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">value_to_set</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ShapeMismatchError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected array of &lt;=2 dimensions, got </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value_to_set</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">updated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">updated</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_to_set</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__deletefile__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">updated</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table does not support deleting columns&quot;</span><span class="p">)</span>
        <span class="n">old_nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__deletefile__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="n">removed</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">old_nrows</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)):</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span> <span class="o">-</span> <span class="n">removed</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">removed</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2"> is out of bounds for axis 0 with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">removed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">old_nrows</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span> <span class="o">-</span> <span class="n">removed</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">removed</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__readfile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the table before using it!&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__writefile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the table before using it!&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__deletefile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the table before using it!&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Class containing the table structure.
The table stores each row in separate files on the machine to offload ram.
Since file structure are not well equipped to handle a (very) large amount of files,
do keep that in mind when initialising tables and transpose the data if necessary.</p>

<p>Tables store rows with other dimensions removed.</p>

<h2 id="slicing">Slicing</h2>

<p>Tables can be accessed using slicing. Slicing in Tables works similar to slicing in Numpy arrays.</p>

<p>Slicing support both get, set, and delete commands.</p>

<h2 id="examples">Examples</h2>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="go">3 &lt;-- this is the element in the second row, in the third column of the `Table`.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">Array([3, 4]) &lt;-- The second and third column of the second row.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">Array([[1,2,3,4],[2,3,4,5],[3,4,5,6],[4,5,6,7]]) &lt;-- The rows from the second row to the fifth row in a `Table` with 4 columns.</span>
</code></pre></div>

<h6 id="args">Args</h6>

<ul>
<li><strong>name:</strong>  The name of the <code><a href="#Table">Table</a></code></li>
<li><strong>database:</strong>  The <code><a href="#Database">Database</a></code> the Table resides in</li>
<li><strong>table_set:</strong>  The <code><a href="#TableSet">TableSet</a></code> that is the parent of this <code><a href="#Table">Table</a></code></li>
</ul>
</div>


                            <div id="Table.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Table.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Table</span><span class="signature">(name: str, database: <a href="#Database">nn_analysis.storage.Database</a>, table_set=None)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">,</span> <span class="n">table_set</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;properties&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="o">=</span> <span class="n">table_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Table.name" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Table.name">#&nbsp;&nbsp</a>

        <span class="name">name</span><span class="annotation">: str</span>
    </div>

    

                            </div>
                            <div id="Table.database" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Table.database">#&nbsp;&nbsp</a>

        <span class="name">database</span><span class="annotation">: <a href="#Database">nn_analysis.storage.Database</a></span>
    </div>

    

                            </div>
                            <div id="Table.verbose" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Table.verbose">#&nbsp;&nbsp</a>

        <span class="name">verbose</span><span class="annotation">: bool</span>
    </div>

    

                            </div>
                            <div id="Table.folder" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Table.folder">#&nbsp;&nbsp</a>

        <span class="name">folder</span>
    </div>

    

                            </div>
                            <div id="Table.shape" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Table.shape">#&nbsp;&nbsp</a>

        <span class="name">shape</span><span class="annotation">: tuple</span>
    </div>

            <div class="docstring"><p>The shape of the table</p>
</div>


                            </div>
                            <div id="Table.nrows" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Table.nrows">#&nbsp;&nbsp</a>

        <span class="name">nrows</span><span class="annotation">: int</span>
    </div>

            <div class="docstring"><p>The number of rows in the table</p>
</div>


                            </div>
                            <div id="Table.ncols" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Table.ncols">#&nbsp;&nbsp</a>

        <span class="name">ncols</span><span class="annotation">: int</span>
    </div>

            <div class="docstring"><p>The number of columns in the table</p>
</div>


                            </div>
                            <div id="Table.dtype" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Table.dtype">#&nbsp;&nbsp</a>

        <span class="name">dtype</span><span class="annotation">: numpy.dtype</span>
    </div>

            <div class="docstring"><p>The datatype of the table</p>
</div>


                            </div>
                            <div id="Table.initialised" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Table.initialised">#&nbsp;&nbsp</a>

        <span class="name">initialised</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Indicates whether the necessary files are initialised and whether the shapes are correct</p>
</div>


                            </div>
                            <div id="Table.change_dtype" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Table.change_dtype">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">change_dtype</span><span class="signature">(self, dtype: numpy.dtype)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">change_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the dtype of the table</span>

<span class="sd">        Args:</span>
<span class="sd">            dtype: The desired `np.dtype`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Changes the dtype of the table</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>dtype:</strong>  The desired <code>np.dtype</code></li>
</ul>
</div>


                            </div>
                            <div id="Table.initialise" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Table.initialise">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">initialise</span><span class="signature">(
    self,
    data: numpy.ndarray,
    dtype: numpy.dtype = None,
    inputs: list = None,
    outputs: list = None
)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">initialise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises the table using the np.ndarray provided</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; Table(&#39;Name&#39;, Database(&#39;path&#39;)).initialise(np.array([[1,2,3,4],[2,3,4,5]]))</span>
<span class="sd">        Creates a table with name &#39;Name&#39; and two rows of data Array([[1,2,3,4], [2,3,4,5]])</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The array containing the data for the Table</span>
<span class="sd">            dtype (optional): The dtype of the data, changes the data&#39;s dtype if they don&#39;t match</span>
<span class="sd">            inputs (optional): Denotes the inputs for the data in this Table represented as a list of Table names. Table names have to be in the same TableSet or Database.</span>
<span class="sd">            outputs (optional): Denotes the outputs for the data in this Table represented as a list of Table names. Table names have to be in the same TableSet or Database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
        <span class="c1"># Make data 2 dimensional</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="c1"># Change dtype if necessary</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="c1"># Go through all the data with a progress bar</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Initialises the table using the np.ndarray provided</p>

<h2 id="examples">Examples</h2>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">Table</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]))</span>
<span class="go">Creates a table with name &#39;Name&#39; and two rows of data Array([[1,2,3,4], [2,3,4,5]])</span>
</code></pre></div>

<h6 id="args">Args</h6>

<ul>
<li><strong>data:</strong>  The array containing the data for the Table</li>
<li><strong>dtype (optional):</strong>  The dtype of the data, changes the data's dtype if they don't match</li>
<li><strong>inputs (optional):</strong>  Denotes the inputs for the data in this Table represented as a list of Table names. Table names have to be in the same TableSet or Database.</li>
<li><strong>outputs (optional):</strong>  Denotes the outputs for the data in this Table represented as a list of Table names. Table names have to be in the same TableSet or Database.</li>
</ul>
</div>


                            </div>
                            <div id="Table.append_rows" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Table.append_rows">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">append_rows</span><span class="signature">(self, data: numpy.ndarray)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">append_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new row to the existing Table</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; Table(&#39;Name&#39;, Database(&#39;path&#39;)).append_rows(np.array([[10,11,12,13], [11, 12, 13, 14]]))</span>
<span class="sd">        Adds rows Array([[10,11,12,13], [11, 12, 13, 14]]) to the existing table at path &#39;path&#39; with name &#39;Name&#39;.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The new rows as an np.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Expected data.shape[1] to match self.ncols!&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reshaped_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nrows</span> <span class="o">+=</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a new row to the existing Table</p>

<h2 id="examples">Examples</h2>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">Table</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]]))</span>
<span class="go">Adds rows Array([[10,11,12,13], [11, 12, 13, 14]]) to the existing table at path &#39;path&#39; with name &#39;Name&#39;.</span>
</code></pre></div>

<h6 id="args">Args</h6>

<ul>
<li><strong>data:</strong>  The new rows as an np.ndarray</li>
</ul>
</div>


                            </div>
                </section>
                <section id="TableSet">
                                <div class="attr class">
        <a class="headerlink" href="#TableSet">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">TableSet</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">TableSet</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A set of `Table`s and or other `TableSet`s.</span>
<span class="sd">    The get, set, and delete functions work on the aggregated table data.</span>
<span class="sd">    To get a specific subtable you can use `get_subtable(key)`</span>

<span class="sd">    Slicing</span>
<span class="sd">    -----------</span>
<span class="sd">    TableSets can be accessed using slicing. Slicing in TableSets works similar to slicing in Numpy arrays.</span>

<span class="sd">    The `TableSet` slicing combines all subtables into one structure. When using slicing the underlying subtables are combined.</span>

<span class="sd">    Slicing support both get, set, and delete commands.</span>

<span class="sd">    Examples</span>
<span class="sd">    -----------</span>
<span class="sd">    &gt;&gt;&gt; tableset[1,2]</span>
<span class="sd">    3 &lt;-- this is the element in the second row, in the third column of the `TableSet`.</span>
<span class="sd">    &gt;&gt;&gt; tableset[1,2:4]</span>
<span class="sd">    Array([3, 4]) &lt;-- The second and third column of the second row.</span>
<span class="sd">    &gt;&gt;&gt; tableset[1:5]</span>
<span class="sd">    Array([[1,2,3,4],[2,3,4,5],[3,4,5,6],[4,5,6,7]]) &lt;-- The rows from the second row to the fifth row in a `TableSet` with 4 columns.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: Name of the `TableSet`.</span>
<span class="sd">        database: The `database` the TableSet is in.</span>
<span class="sd">        table_set (optional): The TableSet this TableSet is a part of.</span>
<span class="sd">        verbose: If true progress bars are shown during some operations</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Name of the TableSet.</span>
<span class="sd">        database: The database the TableSet is in.</span>
<span class="sd">        table_set (optional): The TableSet this TableSet is a part of.</span>
<span class="sd">        verbose (optional, default=False): If true progress bars are shown during some operations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">database</span><span class="p">:</span> <span class="n">Database</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">,</span> <span class="n">table_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="o">=</span> <span class="n">table_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span> <span class="o">=</span> <span class="s1">&#39;properties&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__recurrent_subtables</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Table(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2">), &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">subtable_total</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">subtables</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">subtable_total</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">subtable_total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtables</span><span class="p">)[</span><span class="n">row</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">subtable_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">subtable_total</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtables</span><span class="p">)[</span><span class="n">row</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subtable_total</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subtable_total</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2"> is out of bounds for axis 0 with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">__keytolist__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>

        <span class="c1"># Make sure the shape and types of the keys and the values is something we expect</span>
        <span class="n">single_value</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">len_value</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">len_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">len_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cols</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span>
                <span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">len_value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expected len(value)=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s1">, found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">single_value</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span><span class="p">:</span>
            <span class="n">cols_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">__slicetolist__</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">len_value</span> <span class="o">!=</span> <span class="n">cols_len</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expected len(value)=</span><span class="si">{</span><span class="n">cols_len</span><span class="si">}</span><span class="s1">, found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">cols_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">len_value</span> <span class="o">!=</span> <span class="n">cols_len</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expected len(value)=</span><span class="si">{</span><span class="n">cols_len</span><span class="si">}</span><span class="s1">, found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">single_value</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">len_value</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expected len(value)=1, found len(value)=</span><span class="si">{</span><span class="n">len_value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Go through the subtables to delegate the values to the correct subtables</span>
        <span class="n">min_col</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">subtable_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span>
            <span class="n">max_col</span> <span class="o">=</span> <span class="n">min_col</span> <span class="o">+</span> <span class="n">subtable_instance</span><span class="o">.</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span>
            <span class="c1"># If only one value is changed check if that column is in the subtable and update it accordingly</span>
            <span class="k">if</span> <span class="n">single_value</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">min_col</span> <span class="o">&lt;=</span> <span class="n">cols</span> <span class="o">&lt;=</span> <span class="n">max_col</span><span class="p">:</span>
                    <span class="n">subtable_instance</span><span class="p">[</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Select the columns that are in this subtable</span>
                <span class="n">cols_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">__slicetolist__</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">))</span>
                <span class="n">cols_array</span> <span class="o">=</span> <span class="n">cols_array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&gt;=</span> <span class="n">min_col</span><span class="p">)]</span>
                <span class="n">cols_array</span> <span class="o">=</span> <span class="n">cols_array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&lt;=</span> <span class="n">max_col</span><span class="p">)]</span>
                <span class="n">value_array</span> <span class="o">=</span> <span class="n">value</span>
                <span class="c1"># Select just the values for the columns in this subtable</span>
                <span class="k">if</span> <span class="n">value_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">value_array</span> <span class="o">=</span> <span class="n">value_array</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&gt;=</span> <span class="n">min_col</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">value_array</span> <span class="o">=</span> <span class="n">value_array</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&lt;=</span> <span class="n">max_col</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value_array</span> <span class="o">=</span> <span class="n">value_array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&gt;=</span> <span class="n">min_col</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">value_array</span> <span class="o">=</span> <span class="n">value_array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cols_array</span> <span class="o">&lt;=</span> <span class="n">max_col</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="c1"># Make sure the columns start at the right place</span>
                <span class="n">cols_array</span> <span class="o">=</span> <span class="n">cols_array</span> <span class="o">-</span> <span class="n">min_col</span>
                <span class="c1"># Make the columns a list and update the subtable with the values and columns that were just calculated</span>
                <span class="n">cols_list</span> <span class="o">=</span> <span class="n">cols_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">subtable_instance</span><span class="p">[</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols_list</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_array</span>
            <span class="n">min_col</span> <span class="o">+=</span> <span class="n">subtable_instance</span><span class="o">.</span><span class="n">ncols</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__verify_data_and_names_have_matching_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the data and names have the same size</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The data of the subtables</span>
<span class="sd">            names: The names of the subtables and subtablesets</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if they share the same size, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subdata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_data_and_names_have_matching_shapes</span><span class="p">(</span><span class="n">subdata</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">return</span> <span class="kc">False</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__verify_coherent_data_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the data has a coherent amount of rows everywhere</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The data of the subtables</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if it does, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">subdata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_coherent_data_rows</span><span class="p">(</span><span class="n">subdata</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">nrows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="n">subdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">nrows</span> <span class="o">!=</span> <span class="n">subdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__verify_name_types_are_correct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the names is a dict of dicts or strings everywhere</span>

<span class="sd">        Args:</span>
<span class="sd">            names: The names of the subtables and subtablesets</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if it does, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_name_types_are_correct</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">initialise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">relations</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise the TableSet with the structure set in the data parameter.</span>
<span class="sd">        Names and data need to be of the same shape.</span>

<span class="sd">        The program will use the key of the names dict as the name of the Table or TableSet.</span>

<span class="sd">        It is possible to create sub TableSets by making nested dicts in the names variable and nested tuples in the</span>
<span class="sd">        data variable.</span>

<span class="sd">        Examples</span>
<span class="sd">        -----------</span>
<span class="sd">        &gt;&gt;&gt; TableSet(&#39;Name&#39;, Database(&#39;path&#39;)).initialise((np.array([[1,2,3]]), (np.array([[2,3,4]]))), {&#39;first_subtable&#39;:&#39;&#39;, &#39;second_subtable&#39;:{&#39;first_subtable&#39;:&#39;&#39;}})</span>
<span class="sd">        Initiliases a TableSet in the database with the given data and names</span>
<span class="sd">        &gt;&gt;&gt; TableSet(&#39;Name&#39;).initialise((np.array([[1,2,3]]), (np.array([[2,3,4]]), np.array([[3,4,5]]))), {&#39;first_subtable&#39;:&#39;&#39;, &#39;second_subtable&#39;:{&#39;first_subtable&#39;:&#39;&#39;, &#39;second_subtable&#39;:&#39;&#39;}}, relations={&#39;first_subtable&#39;:([], [&#39;second_subtable&#39;]), &#39;second_subtable&#39;:([&#39;first_subtable&#39;],[],{&#39;first_subtable&#39;:([],[&#39;second_subtable&#39;]), &#39;second_subtable&#39;:([&#39;first_subtable&#39;], [])})})</span>
<span class="sd">        Initialises a TableSet in the database with the given data and names that has defined inputs and outputs</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The data of the subtables</span>
<span class="sd">            names: The names of the subtables and subtablesets</span>
<span class="sd">            dtype (optional): Data type of the array</span>
<span class="sd">            relations (optional): Relations between components of the data in terms of inputs and outputs. Example: `{ &#39;name&#39;: (inputs=list of names, outputs=list of names, child=child dict),  &#39;name2&#39;: (inputs=list of names, outputs=list of names, child=child dict), etc... }`</span>
<span class="sd">            inputs (optional): Denotes the inputs for the data in this TableSet represented as a list of Table names. TableSet names have to be in the same TableSet or Database.</span>
<span class="sd">            outputs (optional): Denotes the outputs for the data in this TableSet represented as a list of Table names. TableSet names have to be in the same TableSet or Database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data is not a tuple of nested tuples of np.ndarrays or a tuple of np.ndarrays!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_name_types_are_correct</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;names is not a dict of nested dicts of strings or a dict of strings!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_data_and_names_have_matching_shapes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data and names do not have the same shape!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_coherent_data_rows</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected the rows of all np.ndarrays in the data variable to be of the same length!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">relations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relations</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">relations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relations</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">child</span> <span class="o">=</span> <span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">relations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relations</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="p">,</span>
                                                                             <span class="n">child</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Expected type&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__verify_ncols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subdata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">subtable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">subtable</span><span class="o">.</span><span class="n">__verify_ncols</span><span class="p">(</span><span class="n">subdata</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">subtable</span><span class="o">.</span><span class="n">ncols</span> <span class="o">!=</span> <span class="n">subdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">append_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">skip_verification</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new rows to the existing TableSet</span>

<span class="sd">        Examples</span>
<span class="sd">        -----------</span>
<span class="sd">        &gt;&gt;&gt; TableSet(&#39;Name&#39;, Database(&#39;path&#39;)).append_rows((np.array([[1,2,3,3]]),))</span>
<span class="sd">        Adds a single row to a TableSet with one subtable with 4 columns</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The new rows as a (nested) tuple of np.ndarrays</span>
<span class="sd">            skip_verification (optional, default=False) : If True the verification steps are skipped. This allows for faster processing and is used when this function calls itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Verify the data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_verification</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data is not a tuple of nested tuples of np.ndarrays or a tuple of np.ndarrays!&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_coherent_data_rows</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected the rows of all np.ndarrays in the data variable to be of the same length!&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_ncols</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;make sure data.ncols is the same as the existing ncols&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subtable_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">subtable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span> <span class="ow">is</span> <span class="n">TableSet</span><span class="p">:</span>
                <span class="n">subtable</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">skip_verification</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">subtable</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shape of the TableSet&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nrows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Amount of rows in this subtable&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">nrows</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ncols</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Total amount of columns in this subtable&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span><span class="o">.</span><span class="n">ncols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="n">total</span>
        <span class="k">return</span> <span class="n">total</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">folder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">subtables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The names of the subtables in this TableSet&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">recurrent_subtables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Dictionary of names of subtables and subsubtables etc.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recurrent_subtables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recurrent_subtables</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">subtable_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subtable_instance</span><span class="p">)</span> <span class="ow">is</span> <span class="n">TableSet</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">subtable</span><span class="p">]</span> <span class="o">=</span> <span class="n">subtable_instance</span><span class="o">.</span><span class="n">recurrent_subtables</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">subtable</span><span class="p">]</span> <span class="o">=</span> <span class="n">subtable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__recurrent_subtables</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ncols_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Amount of columns split up by subtable&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span>
        <span class="n">ncols_tuple</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">subtable_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subtable_instance</span><span class="p">)</span> <span class="ow">is</span> <span class="n">TableSet</span><span class="p">:</span>
                <span class="n">ncols_tuple</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span><span class="o">.</span><span class="n">ncols_tuple</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ncols_tuple</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subtable_instance</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ncols_tuple</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The datatype of the TableSet&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calc_properties__</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span>

    <span class="k">def</span> <span class="nf">change_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the dtype of the TableSet</span>

<span class="sd">        Args:</span>
<span class="sd">            dtype: The desired dtype</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__calc_properties__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the properties of the table including the nrows and ncols&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__readfile__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span>

    <span class="k">def</span> <span class="nf">__update_properties__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__writefile__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">),</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">initialised</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Indicates whether the TableSet was (correctly) initialised&quot;&quot;&quot;</span>
        <span class="n">properties_exist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">properties_exist</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">subtables</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subtables</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">inputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">outputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">print_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints a map of the table structure</span>

<span class="sd">        Args:</span>
<span class="sd">            tabs: (Integer) Amount of tabs to print before the text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_subtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the `Table` or `TableSet` with the key</span>

<span class="sd">        Args:</span>
<span class="sd">            key: The key of the subtable as a string or integer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the TableSet before calling this function!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoSuchTableError</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Table</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>  <span class="c1"># Subtable is a Table</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>  <span class="c1"># Subtable is a TableSet</span>
            <span class="k">return</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">NoSuchTableError</span><span class="p">(</span><span class="s1">&#39;No subtable with this key was found to be initialised!&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__readfile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the TableSet before using it!&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__writefile__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the TableSet before using it!&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>A set of <code><a href="#Table">Table</a></code>s and or other <code><a href="#TableSet">TableSet</a></code>s.
The get, set, and delete functions work on the aggregated table data.
To get a specific subtable you can use <code>get_subtable(key)</code></p>

<h2 id="slicing">Slicing</h2>

<p>TableSets can be accessed using slicing. Slicing in TableSets works similar to slicing in Numpy arrays.</p>

<p>The <code><a href="#TableSet">TableSet</a></code> slicing combines all subtables into one structure. When using slicing the underlying subtables are combined.</p>

<p>Slicing support both get, set, and delete commands.</p>

<h2 id="examples">Examples</h2>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">tableset</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="go">3 &lt;-- this is the element in the second row, in the third column of the `TableSet`.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tableset</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">Array([3, 4]) &lt;-- The second and third column of the second row.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tableset</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">Array([[1,2,3,4],[2,3,4,5],[3,4,5,6],[4,5,6,7]]) &lt;-- The rows from the second row to the fifth row in a `TableSet` with 4 columns.</span>
</code></pre></div>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>name:</strong>  Name of the <code><a href="#TableSet">TableSet</a></code>.</li>
<li><strong>database:</strong>  The <code><a href="#TableSet.database">database</a></code> the TableSet is in.</li>
<li><strong>table_set (optional):</strong>  The TableSet this TableSet is a part of.</li>
<li><strong>verbose:</strong>  If true progress bars are shown during some operations</li>
</ul>

<h6 id="args">Args</h6>

<ul>
<li><strong>name:</strong>  Name of the TableSet.</li>
<li><strong>database:</strong>  The database the TableSet is in.</li>
<li><strong>table_set (optional):</strong>  The TableSet this TableSet is a part of.</li>
<li><strong>verbose (optional, default=False):</strong>  If true progress bars are shown during some operations</li>
</ul>
</div>


                            <div id="TableSet.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#TableSet.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">TableSet</span><span class="signature">(
    name: str,
    database: <a href="#Database">nn_analysis.storage.Database</a>,
    table_set=None,
    verbose=False
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">,</span> <span class="n">table_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_set</span> <span class="o">=</span> <span class="n">table_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__properties_file</span> <span class="o">=</span> <span class="s1">&#39;properties&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ncols_tuple</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__recurrent_subtables</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="TableSet.name" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.name">#&nbsp;&nbsp</a>

        <span class="name">name</span><span class="annotation">: str</span>
    </div>

    

                            </div>
                            <div id="TableSet.database" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.database">#&nbsp;&nbsp</a>

        <span class="name">database</span><span class="annotation">: <a href="#Database">nn_analysis.storage.Database</a></span>
    </div>

    

                            </div>
                            <div id="TableSet.verbose" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.verbose">#&nbsp;&nbsp</a>

        <span class="name">verbose</span><span class="annotation">: bool</span>
    </div>

    

                            </div>
                            <div id="TableSet.initialise" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#TableSet.initialise">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">initialise</span><span class="signature">(
    self,
    data: tuple,
    names: dict,
    dtype: numpy.dtype = None,
    relations: dict = None,
    inputs: list = None,
    outputs: list = None
)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">initialise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">relations</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise the TableSet with the structure set in the data parameter.</span>
<span class="sd">        Names and data need to be of the same shape.</span>

<span class="sd">        The program will use the key of the names dict as the name of the Table or TableSet.</span>

<span class="sd">        It is possible to create sub TableSets by making nested dicts in the names variable and nested tuples in the</span>
<span class="sd">        data variable.</span>

<span class="sd">        Examples</span>
<span class="sd">        -----------</span>
<span class="sd">        &gt;&gt;&gt; TableSet(&#39;Name&#39;, Database(&#39;path&#39;)).initialise((np.array([[1,2,3]]), (np.array([[2,3,4]]))), {&#39;first_subtable&#39;:&#39;&#39;, &#39;second_subtable&#39;:{&#39;first_subtable&#39;:&#39;&#39;}})</span>
<span class="sd">        Initiliases a TableSet in the database with the given data and names</span>
<span class="sd">        &gt;&gt;&gt; TableSet(&#39;Name&#39;).initialise((np.array([[1,2,3]]), (np.array([[2,3,4]]), np.array([[3,4,5]]))), {&#39;first_subtable&#39;:&#39;&#39;, &#39;second_subtable&#39;:{&#39;first_subtable&#39;:&#39;&#39;, &#39;second_subtable&#39;:&#39;&#39;}}, relations={&#39;first_subtable&#39;:([], [&#39;second_subtable&#39;]), &#39;second_subtable&#39;:([&#39;first_subtable&#39;],[],{&#39;first_subtable&#39;:([],[&#39;second_subtable&#39;]), &#39;second_subtable&#39;:([&#39;first_subtable&#39;], [])})})</span>
<span class="sd">        Initialises a TableSet in the database with the given data and names that has defined inputs and outputs</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The data of the subtables</span>
<span class="sd">            names: The names of the subtables and subtablesets</span>
<span class="sd">            dtype (optional): Data type of the array</span>
<span class="sd">            relations (optional): Relations between components of the data in terms of inputs and outputs. Example: `{ &#39;name&#39;: (inputs=list of names, outputs=list of names, child=child dict),  &#39;name2&#39;: (inputs=list of names, outputs=list of names, child=child dict), etc... }`</span>
<span class="sd">            inputs (optional): Denotes the inputs for the data in this TableSet represented as a list of Table names. TableSet names have to be in the same TableSet or Database.</span>
<span class="sd">            outputs (optional): Denotes the outputs for the data in this TableSet represented as a list of Table names. TableSet names have to be in the same TableSet or Database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data is not a tuple of nested tuples of np.ndarrays or a tuple of np.ndarrays!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_name_types_are_correct</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;names is not a dict of nested dicts of strings or a dict of strings!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_data_and_names_have_matching_shapes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data and names do not have the same shape!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_coherent_data_rows</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected the rows of all np.ndarrays in the data variable to be of the same length!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__subtables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">relations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relations</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">relations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relations</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">child</span> <span class="o">=</span> <span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">relations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relations</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="p">,</span>
                                                                             <span class="n">child</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Expected type&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_properties__</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Initialise the TableSet with the structure set in the data parameter.
Names and data need to be of the same shape.</p>

<p>The program will use the key of the names dict as the name of the Table or TableSet.</p>

<p>It is possible to create sub TableSets by making nested dicts in the names variable and nested tuples in the
data variable.</p>

<h2 id="examples">Examples</h2>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">TableSet</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">initialise</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]))),</span> <span class="p">{</span><span class="s1">&#39;first_subtable&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;second_subtable&#39;</span><span class="p">:{</span><span class="s1">&#39;first_subtable&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}})</span>
<span class="go">Initiliases a TableSet in the database with the given data and names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TableSet</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">initialise</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]))),</span> <span class="p">{</span><span class="s1">&#39;first_subtable&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;second_subtable&#39;</span><span class="p">:{</span><span class="s1">&#39;first_subtable&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;second_subtable&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}},</span> <span class="n">relations</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;first_subtable&#39;</span><span class="p">:([],</span> <span class="p">[</span><span class="s1">&#39;second_subtable&#39;</span><span class="p">]),</span> <span class="s1">&#39;second_subtable&#39;</span><span class="p">:([</span><span class="s1">&#39;first_subtable&#39;</span><span class="p">],[],{</span><span class="s1">&#39;first_subtable&#39;</span><span class="p">:([],[</span><span class="s1">&#39;second_subtable&#39;</span><span class="p">]),</span> <span class="s1">&#39;second_subtable&#39;</span><span class="p">:([</span><span class="s1">&#39;first_subtable&#39;</span><span class="p">],</span> <span class="p">[])})})</span>
<span class="go">Initialises a TableSet in the database with the given data and names that has defined inputs and outputs</span>
</code></pre></div>

<h6 id="args">Args</h6>

<ul>
<li><strong>data:</strong>  The data of the subtables</li>
<li><strong>names:</strong>  The names of the subtables and subtablesets</li>
<li><strong>dtype (optional):</strong>  Data type of the array</li>
<li>**relations (optional): Relations between components of the data in terms of inputs and outputs. Example: <code>{ 'name': (inputs=list of names, outputs=list of names, child=child dict),  'name2':**  (inputs=list of names, outputs=list of names, child=child dict), etc... }</code></li>
<li><strong>inputs (optional):</strong>  Denotes the inputs for the data in this TableSet represented as a list of Table names. TableSet names have to be in the same TableSet or Database.</li>
<li><strong>outputs (optional):</strong>  Denotes the outputs for the data in this TableSet represented as a list of Table names. TableSet names have to be in the same TableSet or Database.</li>
</ul>
</div>


                            </div>
                            <div id="TableSet.append_rows" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#TableSet.append_rows">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">append_rows</span><span class="signature">(self, data: tuple, skip_verification: bool = False)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">append_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">skip_verification</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new rows to the existing TableSet</span>

<span class="sd">        Examples</span>
<span class="sd">        -----------</span>
<span class="sd">        &gt;&gt;&gt; TableSet(&#39;Name&#39;, Database(&#39;path&#39;)).append_rows((np.array([[1,2,3,3]]),))</span>
<span class="sd">        Adds a single row to a TableSet with one subtable with 4 columns</span>

<span class="sd">        Args:</span>
<span class="sd">            data: The new rows as a (nested) tuple of np.ndarrays</span>
<span class="sd">            skip_verification (optional, default=False) : If True the verification steps are skipped. This allows for faster processing and is used when this function calls itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Verify the data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_verification</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data is not a tuple of nested tuples of np.ndarrays or a tuple of np.ndarrays!&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_coherent_data_rows</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected the rows of all np.ndarrays in the data variable to be of the same length!&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_ncols</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;make sure data.ncols is the same as the existing ncols&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">subtable_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="n">subtable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span> <span class="ow">is</span> <span class="n">TableSet</span><span class="p">:</span>
                <span class="n">subtable</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">skip_verification</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">subtable</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a new rows to the existing TableSet</p>

<h2 id="examples">Examples</h2>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">TableSet</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">append_rows</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]]),))</span>
<span class="go">Adds a single row to a TableSet with one subtable with 4 columns</span>
</code></pre></div>

<h6 id="args">Args</h6>

<ul>
<li><strong>data:</strong>  The new rows as a (nested) tuple of np.ndarrays</li>
<li><strong>skip_verification (optional, default=False) :</strong>  If True the verification steps are skipped. This allows for faster processing and is used when this function calls itself.</li>
</ul>
</div>


                            </div>
                            <div id="TableSet.shape" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.shape">#&nbsp;&nbsp</a>

        <span class="name">shape</span><span class="annotation">: (&lt;class &#39;int&#39;&gt;, &lt;class &#39;int&#39;&gt;)</span>
    </div>

            <div class="docstring"><p>Shape of the TableSet</p>
</div>


                            </div>
                            <div id="TableSet.nrows" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.nrows">#&nbsp;&nbsp</a>

        <span class="name">nrows</span><span class="annotation">: int</span>
    </div>

            <div class="docstring"><p>Amount of rows in this subtable</p>
</div>


                            </div>
                            <div id="TableSet.ncols" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.ncols">#&nbsp;&nbsp</a>

        <span class="name">ncols</span><span class="annotation">: int</span>
    </div>

            <div class="docstring"><p>Total amount of columns in this subtable</p>
</div>


                            </div>
                            <div id="TableSet.folder" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.folder">#&nbsp;&nbsp</a>

        <span class="name">folder</span><span class="annotation">: str</span>
    </div>

    

                            </div>
                            <div id="TableSet.subtables" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.subtables">#&nbsp;&nbsp</a>

        <span class="name">subtables</span><span class="annotation">: list</span>
    </div>

            <div class="docstring"><p>The names of the subtables in this TableSet</p>
</div>


                            </div>
                            <div id="TableSet.recurrent_subtables" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.recurrent_subtables">#&nbsp;&nbsp</a>

        <span class="name">recurrent_subtables</span><span class="annotation">: dict</span>
    </div>

            <div class="docstring"><p>Dictionary of names of subtables and subsubtables etc.</p>
</div>


                            </div>
                            <div id="TableSet.ncols_tuple" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.ncols_tuple">#&nbsp;&nbsp</a>

        <span class="name">ncols_tuple</span><span class="annotation">: tuple</span>
    </div>

            <div class="docstring"><p>Amount of columns split up by subtable</p>
</div>


                            </div>
                            <div id="TableSet.dtype" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.dtype">#&nbsp;&nbsp</a>

        <span class="name">dtype</span><span class="annotation">: numpy.dtype</span>
    </div>

            <div class="docstring"><p>The datatype of the TableSet</p>
</div>


                            </div>
                            <div id="TableSet.change_dtype" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#TableSet.change_dtype">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">change_dtype</span><span class="signature">(self, dtype: numpy.dtype)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">change_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the dtype of the TableSet</span>

<span class="sd">        Args:</span>
<span class="sd">            dtype: The desired dtype</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subtable</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_subtable</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Changes the dtype of the TableSet</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>dtype:</strong>  The desired dtype</li>
</ul>
</div>


                            </div>
                            <div id="TableSet.initialised" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TableSet.initialised">#&nbsp;&nbsp</a>

        <span class="name">initialised</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Indicates whether the TableSet was (correctly) initialised</p>
</div>


                            </div>
                            <div id="TableSet.print_structure" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#TableSet.print_structure">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">print_structure</span><span class="signature">(self, tabs=0)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">print_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints a map of the table structure</span>

<span class="sd">        Args:</span>
<span class="sd">            tabs: (Integer) Amount of tabs to print before the text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Prints a map of the table structure</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>tabs:</strong>  (Integer) Amount of tabs to print before the text</li>
</ul>
</div>


                            </div>
                            <div id="TableSet.get_subtable" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#TableSet.get_subtable">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_subtable</span><span class="signature">(self, key: Union[str, int])</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_subtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the `Table` or `TableSet` with the key</span>

<span class="sd">        Args:</span>
<span class="sd">            key: The key of the subtable as a string or integer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableNotInitialisedError</span><span class="p">(</span><span class="s2">&quot;Initialise the TableSet before calling this function!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoSuchTableError</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtables</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Table</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>  <span class="c1"># Subtable is a Table</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>  <span class="c1"># Subtable is a TableSet</span>
            <span class="k">return</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">NoSuchTableError</span><span class="p">(</span><span class="s1">&#39;No subtable with this key was found to be initialised!&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Returns the <code><a href="#Table">Table</a></code> or <code><a href="#TableSet">TableSet</a></code> with the key</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>key:</strong>  The key of the subtable as a string or integer</li>
</ul>
</div>


                            </div>
                </section>
                <section id="StorageManager">
                                <div class="attr class">
        <a class="headerlink" href="#StorageManager">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">StorageManager</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">StorageManager</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class handling often used storage related queries such as saving results from an experiment or from fitting to a `TableSet`</span>

<span class="sd">    Args:</span>
<span class="sd">        database: `Database` the `Table`s and `TableSet`s should reside in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">database</span><span class="p">:</span> <span class="n">Database</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>

    <span class="k">def</span> <span class="nf">save_result_table_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table_labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">ncols</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">row_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                              <span class="n">append_rows</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TableSet</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function that saves a `TableSet` with the results.</span>
<span class="sd">        Results do not have to be complete. If the result is incomplete provide the nrows or ncols parameters.</span>
<span class="sd">        The lacking rows or columns will then be filled with zeros. When providing the additional results use the</span>
<span class="sd">        row_start and col_start parameters to indicate where the existing TableSet is to be overridden.</span>

<span class="sd">        If a result tuple is incomplete and has completely missing parts fill in the missing parts with None values.</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[1,2,3,4], [2,3,4,5]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;})</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows of data in a single subtable</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[1,2,3,4], [2,3,4,5]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, nrows=4)</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows of data appended with two rows of zeros in a single subtable</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[1,2,3,4], [2,3,4,5]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, ncols=(6,))</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows and four columns of data appended with two columns of zeros in a single subtable</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[3,4,5,6], [4,5,6,7]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, row_start=2)</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with four rows. The original `TableSet` was changed in rows 2 and 3 with the data given here.</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[3,4,5,6], [4,5,6,7]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, append_rows=True)</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with four rows. The original `TableSet` was appended with the two rows given here.</span>

<span class="sd">        Args:</span>
<span class="sd">            results: A (nested) tuple of np.ndarrays containing results</span>
<span class="sd">            name: (str) The name of the `TableSet` to be created or updated</span>
<span class="sd">            table_labels: A (nested) dictionary of the names of the `Table`s/`SubTable`s in the `TableSet`</span>
<span class="sd">            nrows (optional): Amount of rows that will (eventually) be in the `TableSet`. If not provided `nrows=results.shape[0]`</span>
<span class="sd">            ncols (optional): Amount of columns that will (eventually) be in the table set per subpart of the data. If not provided `ncols[i]=results[i].shape[1]`</span>
<span class="sd">            row_start (optional, default=0): Int of the row where the results start. This parameter is used if nrows does not match the amount of rows in the results.</span>
<span class="sd">            col_start (optional, default=0): Int of the column where the results start. This parameter is used if ncols does not match the amount of columns in the results.</span>
<span class="sd">            append_rows (optional, default=False): If true, when the `TableSet` is already initialised the results will be appended as rows to the existing `TableSet`</span>

<span class="sd">        Returns:</span>
<span class="sd">            `TableSet` containing the results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table_set</span> <span class="o">=</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;results is not a tuple of nested tuples of np.ndarrays or a tuple of np.ndarrays!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_results_and_ncols_shape</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">ncols</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ncols and results should be of the same shape&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_nrows_calculation</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nrows</span><span class="p">):</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fetch_nrows_from_partial_result_set</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_ncols_to_be_set_somewhere</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;When one of the results is None, ncols has to be set for that result!&#39;</span><span class="p">)</span>
        <span class="n">padded_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pad_with_zeros</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table_set</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>  <span class="c1"># Update existing TableSet</span>
            <span class="k">if</span> <span class="n">append_rows</span><span class="p">:</span>
                <span class="n">table_set</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">padded_results</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Combine the small arrays into one large array so we can use the TableSet update function</span>
                <span class="n">combined_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__combine_into_big_array</span><span class="p">(</span><span class="n">padded_results</span><span class="p">)</span>
                <span class="n">table_set</span><span class="p">[</span><span class="n">row_start</span><span class="p">:</span><span class="n">combined_results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">row_start</span><span class="p">,</span>
                          <span class="n">col_start</span><span class="p">:</span><span class="n">combined_results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">col_start</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_results</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">table_set</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">padded_results</span><span class="p">,</span> <span class="n">table_labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">table_set</span>

    <span class="k">def</span> <span class="nf">open_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a `Table` or `TableSet` in the `Database` with the given name.</span>
<span class="sd">        The function can automatically distinguish between `Table`s and `TableSet`s.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).open_table(&#39;Name&#39;)</span>
<span class="sd">        Table(&#39;Name&#39;) or TableSet(&#39;Name&#39;) if a `Table` or `TableSet` exists in this database.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the `Table` or `TableSet`</span>

<span class="sd">        Returns:</span>
<span class="sd">            `Table` or `TableSet`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoSuchTableError</span>

    <span class="k">def</span> <span class="nf">remove_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a table from the `Database`</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).remove_table(&#39;Name&#39;)</span>
<span class="sd">        Removes table with the name &#39;Name&#39; from the database at path &#39;path&#39;.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the `Table`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__requires_nrows_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nrows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># If the result is a tuple unpack it further</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_nrows_calculation</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__requires_ncols_to_be_set_somewhere</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># If the result is a tuple unpack it further</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_nrows_calculation</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__fetch_nrows_from_partial_result_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">nrows_subresult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fetch_nrows_from_partial_result_set</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nrows_subresult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">nrows_subresult</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;When all results are None values nrows has to be set!&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__verify_results_and_ncols_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ncols</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">tuple</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_results_and_ncols_shape</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__pad_with_zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">final_result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># If the result is a tuple unpack it further</span>
                <span class="n">this_ncols</span> <span class="o">=</span> <span class="n">ncols</span>
                <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">this_ncols</span> <span class="o">=</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__pad_with_zeros</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">this_ncols</span><span class="p">,</span> <span class="n">nrows</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># If the result is None fill the result using the ncols and nrows</span>
                <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;When a particular result is None, ncols for that result has to be set!&#39;</span><span class="p">)</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># If the result is a result fit it in a padded result array of shape (ncols, nrows)</span>
                <span class="n">flattened_array</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">this_nrows</span> <span class="o">=</span> <span class="n">flattened_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">this_ncols</span> <span class="o">=</span> <span class="n">flattened_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">nrows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">this_nrows</span> <span class="o">=</span> <span class="n">nrows</span>
                <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">this_ncols</span> <span class="o">=</span> <span class="n">ncols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">padded_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">this_nrows</span><span class="p">,</span> <span class="n">this_ncols</span><span class="p">))</span>
                <span class="n">padded_array</span><span class="p">[:,</span> <span class="p">:</span><span class="n">flattened_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">flattened_array</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">padded_array</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">final_result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__combine_into_big_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">final_result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__combine_into_big_array</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">final_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">final_result</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Class handling often used storage related queries such as saving results from an experiment or from fitting to a <code><a href="#TableSet">TableSet</a></code></p>

<h6 id="args">Args</h6>

<ul>
<li><strong>database:</strong>  <code><a href="#Database">Database</a></code> the <code><a href="#Table">Table</a></code>s and <code><a href="#TableSet">TableSet</a></code>s should reside in</li>
</ul>
</div>


                            <div id="StorageManager.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#StorageManager.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">StorageManager</span><span class="signature">(database: <a href="#Database">nn_analysis.storage.Database</a>)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="StorageManager.database" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#StorageManager.database">#&nbsp;&nbsp</a>

        <span class="name">database</span><span class="annotation">: <a href="#Database">nn_analysis.storage.Database</a></span>
    </div>

    

                            </div>
                            <div id="StorageManager.save_result_table_set" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#StorageManager.save_result_table_set">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">save_result_table_set</span><span class="signature">(
    self,
    results: tuple,
    name: str,
    table_labels: dict,
    nrows: int = None,
    ncols: tuple = None,
    row_start: int = 0,
    col_start: int = 0,
    append_rows: bool = False
) -&gt; <a href="#TableSet">nn_analysis.storage.TableSet</a></span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">save_result_table_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table_labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">ncols</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">row_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                              <span class="n">append_rows</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TableSet</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function that saves a `TableSet` with the results.</span>
<span class="sd">        Results do not have to be complete. If the result is incomplete provide the nrows or ncols parameters.</span>
<span class="sd">        The lacking rows or columns will then be filled with zeros. When providing the additional results use the</span>
<span class="sd">        row_start and col_start parameters to indicate where the existing TableSet is to be overridden.</span>

<span class="sd">        If a result tuple is incomplete and has completely missing parts fill in the missing parts with None values.</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[1,2,3,4], [2,3,4,5]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;})</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows of data in a single subtable</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[1,2,3,4], [2,3,4,5]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, nrows=4)</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows of data appended with two rows of zeros in a single subtable</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[1,2,3,4], [2,3,4,5]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, ncols=(6,))</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows and four columns of data appended with two columns of zeros in a single subtable</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[3,4,5,6], [4,5,6,7]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, row_start=2)</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with four rows. The original `TableSet` was changed in rows 2 and 3 with the data given here.</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).save_result_table_set((np.array([[3,4,5,6], [4,5,6,7]]),), &#39;TableSetName&#39;, {&#39;first&#39;:&#39;&#39;}, append_rows=True)</span>
<span class="sd">        TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with four rows. The original `TableSet` was appended with the two rows given here.</span>

<span class="sd">        Args:</span>
<span class="sd">            results: A (nested) tuple of np.ndarrays containing results</span>
<span class="sd">            name: (str) The name of the `TableSet` to be created or updated</span>
<span class="sd">            table_labels: A (nested) dictionary of the names of the `Table`s/`SubTable`s in the `TableSet`</span>
<span class="sd">            nrows (optional): Amount of rows that will (eventually) be in the `TableSet`. If not provided `nrows=results.shape[0]`</span>
<span class="sd">            ncols (optional): Amount of columns that will (eventually) be in the table set per subpart of the data. If not provided `ncols[i]=results[i].shape[1]`</span>
<span class="sd">            row_start (optional, default=0): Int of the row where the results start. This parameter is used if nrows does not match the amount of rows in the results.</span>
<span class="sd">            col_start (optional, default=0): Int of the column where the results start. This parameter is used if ncols does not match the amount of columns in the results.</span>
<span class="sd">            append_rows (optional, default=False): If true, when the `TableSet` is already initialised the results will be appended as rows to the existing `TableSet`</span>

<span class="sd">        Returns:</span>
<span class="sd">            `TableSet` containing the results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table_set</span> <span class="o">=</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">__verify_data_types_are_correct__</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;results is not a tuple of nested tuples of np.ndarrays or a tuple of np.ndarrays!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__verify_results_and_ncols_shape</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">ncols</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ncols and results should be of the same shape&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_nrows_calculation</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nrows</span><span class="p">):</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fetch_nrows_from_partial_result_set</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ncols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__requires_ncols_to_be_set_somewhere</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;When one of the results is None, ncols has to be set for that result!&#39;</span><span class="p">)</span>
        <span class="n">padded_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pad_with_zeros</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table_set</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>  <span class="c1"># Update existing TableSet</span>
            <span class="k">if</span> <span class="n">append_rows</span><span class="p">:</span>
                <span class="n">table_set</span><span class="o">.</span><span class="n">append_rows</span><span class="p">(</span><span class="n">padded_results</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Combine the small arrays into one large array so we can use the TableSet update function</span>
                <span class="n">combined_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__combine_into_big_array</span><span class="p">(</span><span class="n">padded_results</span><span class="p">)</span>
                <span class="n">table_set</span><span class="p">[</span><span class="n">row_start</span><span class="p">:</span><span class="n">combined_results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">row_start</span><span class="p">,</span>
                          <span class="n">col_start</span><span class="p">:</span><span class="n">combined_results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">col_start</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_results</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">table_set</span><span class="o">.</span><span class="n">initialise</span><span class="p">(</span><span class="n">padded_results</span><span class="p">,</span> <span class="n">table_labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">table_set</span>
</pre></div>

        </details>

            <div class="docstring"><p>Function that saves a <code><a href="#TableSet">TableSet</a></code> with the results.
Results do not have to be complete. If the result is incomplete provide the nrows or ncols parameters.
The lacking rows or columns will then be filled with zeros. When providing the additional results use the
row_start and col_start parameters to indicate where the existing TableSet is to be overridden.</p>

<p>If a result tuple is incomplete and has completely missing parts fill in the missing parts with None values.</p>

<h2 id="examples">Examples</h2>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">StorageManager</span><span class="p">(</span><span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">save_result_table_set</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]),),</span> <span class="s1">&#39;TableSetName&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">})</span>
<span class="go">TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows of data in a single subtable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">StorageManager</span><span class="p">(</span><span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">save_result_table_set</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]),),</span> <span class="s1">&#39;TableSetName&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">},</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows of data appended with two rows of zeros in a single subtable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">StorageManager</span><span class="p">(</span><span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">save_result_table_set</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]),),</span> <span class="s1">&#39;TableSetName&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">},</span> <span class="n">ncols</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,))</span>
<span class="go">TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with the two rows and four columns of data appended with two columns of zeros in a single subtable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">StorageManager</span><span class="p">(</span><span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">save_result_table_set</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]]),),</span> <span class="s1">&#39;TableSetName&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">},</span> <span class="n">row_start</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with four rows. The original `TableSet` was changed in rows 2 and 3 with the data given here.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">StorageManager</span><span class="p">(</span><span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">save_result_table_set</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]]),),</span> <span class="s1">&#39;TableSetName&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">},</span> <span class="n">append_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">TableSet(&#39;TableSetName&#39;) &lt;-- `TableSet` with four rows. The original `TableSet` was appended with the two rows given here.</span>
</code></pre></div>

<h6 id="args">Args</h6>

<ul>
<li><strong>results:</strong>  A (nested) tuple of np.ndarrays containing results</li>
<li><strong>name:</strong>  (str) The name of the <code><a href="#TableSet">TableSet</a></code> to be created or updated</li>
<li><strong>table_labels:</strong>  A (nested) dictionary of the names of the <code><a href="#Table">Table</a></code>s/<code>SubTable</code>s in the <code><a href="#TableSet">TableSet</a></code></li>
<li><strong>nrows (optional):</strong>  Amount of rows that will (eventually) be in the <code><a href="#TableSet">TableSet</a></code>. If not provided <code>nrows=results.shape[0]</code></li>
<li><strong>ncols (optional):</strong>  Amount of columns that will (eventually) be in the table set per subpart of the data. If not provided <code>ncols[i]=results[i].shape[1]</code></li>
<li><strong>row_start (optional, default=0):</strong>  Int of the row where the results start. This parameter is used if nrows does not match the amount of rows in the results.</li>
<li><strong>col_start (optional, default=0):</strong>  Int of the column where the results start. This parameter is used if ncols does not match the amount of columns in the results.</li>
<li><strong>append_rows (optional, default=False):</strong>  If true, when the <code><a href="#TableSet">TableSet</a></code> is already initialised the results will be appended as rows to the existing <code><a href="#TableSet">TableSet</a></code></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p><code><a href="#TableSet">TableSet</a></code> containing the results</p>
</blockquote>
</div>


                            </div>
                            <div id="StorageManager.open_table" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#StorageManager.open_table">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">open_table</span><span class="signature">(self, name: str)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">open_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a `Table` or `TableSet` in the `Database` with the given name.</span>
<span class="sd">        The function can automatically distinguish between `Table`s and `TableSet`s.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).open_table(&#39;Name&#39;)</span>
<span class="sd">        Table(&#39;Name&#39;) or TableSet(&#39;Name&#39;) if a `Table` or `TableSet` exists in this database.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the `Table` or `TableSet`</span>

<span class="sd">        Returns:</span>
<span class="sd">            `Table` or `TableSet`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">TableSet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoSuchTableError</span>
</pre></div>

        </details>

            <div class="docstring"><p>Opens a <code><a href="#Table">Table</a></code> or <code><a href="#TableSet">TableSet</a></code> in the <code><a href="#Database">Database</a></code> with the given name.
The function can automatically distinguish between <code><a href="#Table">Table</a></code>s and <code><a href="#TableSet">TableSet</a></code>s.</p>

<h2 id="examples">Examples</h2>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">StorageManager</span><span class="p">(</span><span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">open_table</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
<span class="go">Table(&#39;Name&#39;) or TableSet(&#39;Name&#39;) if a `Table` or `TableSet` exists in this database.</span>
</code></pre></div>

<h6 id="args">Args</h6>

<ul>
<li><strong>name:</strong>  Name of the <code><a href="#Table">Table</a></code> or <code><a href="#TableSet">TableSet</a></code></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p><code><a href="#Table">Table</a></code> or <code><a href="#TableSet">TableSet</a></code></p>
</blockquote>
</div>


                            </div>
                            <div id="StorageManager.remove_table" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#StorageManager.remove_table">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_table</span><span class="signature">(self, name: str)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a table from the `Database`</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; StorageManager(Database(&#39;path&#39;)).remove_table(&#39;Name&#39;)</span>
<span class="sd">        Removes table with the name &#39;Name&#39; from the database at path &#39;path&#39;.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the `Table`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Deletes a table from the <code><a href="#Database">Database</a></code></p>

<h2 id="examples">Examples</h2>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">StorageManager</span><span class="p">(</span><span class="n">Database</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">remove_table</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
<span class="go">Removes table with the name &#39;Name&#39; from the database at path &#39;path&#39;.</span>
</code></pre></div>

<h6 id="args">Args</h6>

<ul>
<li><strong>name:</strong>  The name of the <code><a href="#Table">Table</a></code></li>
</ul>
</div>


                            </div>
                </section>
    </main>
</body>
</html>